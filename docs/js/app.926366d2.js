(function(e){function r(r){for(var t,s,o=r[0],c=r[1],l=r[2],h=0,p=[];h<o.length;h++)s=o[h],i[s]&&p.push(i[s][0]),i[s]=0;for(t in c)Object.prototype.hasOwnProperty.call(c,t)&&(e[t]=c[t]);f&&f(r);while(p.length)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,r=0;r<a.length;r++){for(var n=a[r],t=!0,o=1;o<n.length;o++){var c=n[o];0!==i[c]&&(t=!1)}t&&(a.splice(r--,1),e=s(s.s=n[0]))}return e}var t={},i={app:0},a=[];function s(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,r,n){s.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,r){if(1&r&&(e=s(e)),8&r)return e;if(4&r&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var t in e)s.d(n,t,function(r){return e[r]}.bind(null,t));return n},s.n=function(e){var r=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(r,"a",r),r},s.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},s.p="/perspective-transform/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=r,o=o.slice();for(var l=0;l<o.length;l++)r(o[l]);var f=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,r,n){e.exports=n("56d7")},"419c":function(e,r,n){"use strict";var t=n("9ef0"),i=n.n(t);i.a},"56d7":function(e,r,n){"use strict";n.r(r);n("cadf"),n("551c"),n("f751"),n("097d");var t=n("2b0e"),i=function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("div",{attrs:{id:"app"}},[n("h1",[e._v("Perspective Transform")]),n("PerspectiveTransform")],1)},a=[],s=function(){var e=this,r=e.$createElement,n=e._self._c||r;return n("div",[n("canvas",{ref:"original",staticClass:"renderer"}),n("canvas",{ref:"preview",staticClass:"renderer"})])},o=[],c=n("75fc"),l=(n("ac6a"),n("768b")),f=n("5a89"),h=n("23ee"),p=n("1775"),u=n.n(p),d=n("e59c"),v=n.n(d);function O(e,r){var n=Object(l["a"])(v()(e,r).coeffs,9),t=n[0],i=n[1],a=n[2],s=n[3],o=n[4],c=n[5],h=n[6],p=n[7],u=n[8],d=new f["j"];return d.set(t,i,0,a,s,o,0,c,0,0,1,0,h,p,0,u),d}var m=n("f012"),g=n.n(m),w={name:"PerspectiveTransform",data:function(){return{canvasSize:{width:500,height:500},rendererOfOriginal:null,rendererOfPreview:null,sceneOfOriginal:null,sceneOfPreview:null,cameraOfOriginal:null,cameraOfPreview:null,imageMesh:null,previewMesh:null,cameraOptions:{fov:75,aspect:1,near:.1,far:1e3},cornerMeshes:[],polyline:null}},computed:{positions:function(){return this.cornerMeshes.map(function(e){return{x:e.position.x,y:e.position.y}})}},mounted:function(){this.createRenderer(),this.createScene(),this.createCamera(),this.createImageMesh(),this.createCornerMesh(),this.createPolyline(),this.createHelper(),this.createTweakPane(),this.render()},methods:{createRenderer:function(){var e=this.canvasSize,r=e.width,n=e.height;this.rendererOfOriginal=new f["t"]({canvas:this.$refs.original,alpha:!0,antialias:!0}),this.rendererOfPreview=new f["t"]({canvas:this.$refs.preview,alpha:!0,antialias:!0}),this.rendererOfOriginal.setSize(r,n),this.rendererOfPreview.setSize(r,n)},createScene:function(){this.sceneOfOriginal=new f["p"],this.sceneOfPreview=new f["p"]},createCamera:function(){var e=this.canvasSize.height,r=this.cameraOptions,n=r.fov,t=r.aspect,i=r.near,a=r.far,s=new f["m"](n,t,i,a);s.position.z=e/2/Math.tan(f["i"].degToRad(n/2)),this.cameraOfOriginal=s.clone(),this.cameraOfPreview=s.clone(),this.sceneOfOriginal.add(this.cameraOfOriginal),this.sceneOfPreview.add(this.cameraOfPreview)},createImageMesh:function(){var e=new f["q"],r=e.load(g.a);r.minFilter=f["h"],r.magFilter=f["h"];var n=this.canvasSize,t=n.width,i=n.height,a=new f["k"](new f["a"](t,i,0),new f["l"]({map:r}));this.imageMesh=a.clone(),this.previewMesh=a.clone(),this.sceneOfOriginal.add(this.imageMesh),this.sceneOfPreview.add(this.previewMesh)},createCornerMesh:function(){var e=this,r=[[-100,-100],[100,-100],[100,100],[-100,100]];r.forEach(function(r){var n=Object(l["a"])(r,2),t=n[0],i=n[1],a=new f["k"](new f["c"](5,32),new f["l"]({color:"#00ff00"}));a.position.set(t,i,1),e.cornerMeshes.push(a),e.sceneOfOriginal.add(a)})},createPolyline:function(){var e=new f["g"]({color:65280}),r=new f["e"];r.vertices.push(new f["s"](-100,-100,1),new f["s"](100,-100,1),new f["s"](100,100,1),new f["s"](-100,100,1),new f["s"](-100,-100,1)),this.polyline=new f["f"](r,e),this.sceneOfOriginal.add(this.polyline)},updatePosition:function(){var e=this;this.positions.forEach(function(r,n){var t=r.x,i=r.y;if(0!==n)e.polyline.geometry.vertices[n].setX(t),e.polyline.geometry.vertices[n].setY(i);else{var a=e.polyline.geometry.vertices.length-1;e.polyline.geometry.vertices[n].setX(t),e.polyline.geometry.vertices[n].setY(i),e.polyline.geometry.vertices[a].setX(t),e.polyline.geometry.vertices[a].setY(i)}}),this.polyline.geometry.verticesNeedUpdate=!0},applyTransform:function(){var e=this.cornerMeshes.reduce(function(e,r){return[].concat(Object(c["a"])(e),[r.position.x,r.position.y])},[]),r=this.$refs.original.width/2,n=this.$refs.original.height/2,t=[-r,-n,r,-n,r,n,-r,n];this.previewMesh.matrix=O(e,t),this.previewMesh.matrixAutoUpdate=!1},render:function(){this.updatePosition(),this.applyTransform(),this.rendererOfOriginal.render(this.sceneOfOriginal,this.cameraOfOriginal),this.rendererOfPreview.render(this.sceneOfPreview,this.cameraOfPreview),requestAnimationFrame(this.render)},createHelper:function(){new h["a"](this.cornerMeshes,this.cameraOfOriginal,this.rendererOfOriginal.domElement)},createTweakPane:function(){var e=this,r=new u.a,n=function(){var n=r.addFolder({title:"PerspectiveCamera"});n.addInput(e.cameraOptions,"fov"),n.addInput(e.cameraOptions,"aspect"),n.addInput(e.cameraOptions,"near"),n.addInput(e.cameraOptions,"far"),n.addInput(e.cameraOfOriginal.position,"x"),n.addInput(e.cameraOfOriginal.position,"y"),n.addInput(e.cameraOfOriginal.position,"z")};n()}}},y=w,P=(n("419c"),n("2877")),b=Object(P["a"])(y,s,o,!1,null,"d321090c",null),M=b.exports,x={name:"app",components:{PerspectiveTransform:M}},j=x,S=Object(P["a"])(j,i,a,!1,null,null,null),T=S.exports;t["a"].config.productionTip=!1,new t["a"]({render:function(e){return e(T)}}).$mount("#app")},"9ef0":function(e,r,n){},f012:function(e,r,n){e.exports=n.p+"img/clock.8341b588.jpg"}});
//# sourceMappingURL=app.926366d2.js.map