(function(e){function n(n){for(var r,s,o=n[0],c=n[1],h=n[2],l=0,p=[];l<o.length;l++)s=o[l],i[s]&&p.push(i[s][0]),i[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);f&&f(n);while(p.length)p.shift()();return a.push.apply(a,h||[]),t()}function t(){for(var e,n=0;n<a.length;n++){for(var t=a[n],r=!0,o=1;o<t.length;o++){var c=t[o];0!==i[c]&&(r=!1)}r&&(a.splice(n--,1),e=s(s.s=t[0]))}return e}var r={},i={app:0},a=[];function s(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=e,s.c=r,s.d=function(e,n,t){s.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,n){if(1&n&&(e=s(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)s.d(t,r,function(n){return e[n]}.bind(null,r));return t},s.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(n,"a",n),n},s.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},s.p="/perspective-transform/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=n,o=o.slice();for(var h=0;h<o.length;h++)n(o[h]);var f=c;a.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"56d7":function(e,n,t){"use strict";t.r(n);t("cadf"),t("551c"),t("f751"),t("097d");var r=t("2b0e"),i=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{attrs:{id:"app"}},[t("h1",[e._v("Perspective Transform")]),t("PerspectiveTransform")],1)},a=[],s=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("canvas",{ref:"original",staticClass:"renderer"}),t("canvas",{ref:"preview",staticClass:"renderer"})])},o=[],c=t("75fc"),h=(t("ac6a"),t("5a89")),f=t("23ee"),l=t("1775"),p=t.n(l),u=t("768b"),d=t("e59c"),v=t.n(d);function m(e,n){var t=Object(u["a"])(v()(e,n).coeffs,9),r=t[0],i=t[1],a=t[2],s=t[3],o=t[4],c=t[5],f=t[6],l=t[7],p=t[8],d=new h["j"];return d.set(r,i,0,a,s,o,0,c,0,0,1,0,f,l,0,p),d}var O=t("f012"),g=t.n(O),w={name:"PerspectiveTransform",data:function(){return{canvasSize:{width:500,height:500},rendererOfOriginal:null,rendererOfPreview:null,sceneOfOriginal:null,sceneOfPreview:null,cameraOfOriginal:null,cameraOfPreview:null,imageMesh:null,previewMesh:null,cameraOptions:{fov:75,aspect:1,near:.1,far:1e3},cornerMeshes:[],positions:[new h["t"](-100,100,1),new h["t"](100,100,1),new h["t"](100,-100,1),new h["t"](-100,-100,1)],planeMesh:null,lineSegments:null}},computed:{namedPositions:function(){return{topLeft:this.positions[3],topRight:this.positions[2],bottomRight:this.positions[1],bottomLeft:this.positions[0]}}},mounted:function(){this.createRenderer(),this.createScene(),this.createCamera(),this.createImageMesh(),this.createCornerMesh(),this.createPlaneMesh(),this.createHelper(),this.render()},methods:{createRenderer:function(){var e=this.canvasSize,n=e.width,t=e.height;this.rendererOfOriginal=new h["u"]({canvas:this.$refs.original,alpha:!0,antialias:!0}),this.rendererOfPreview=new h["u"]({canvas:this.$refs.preview,alpha:!0,antialias:!0}),this.rendererOfOriginal.setSize(n,t),this.rendererOfPreview.setSize(n,t)},createScene:function(){this.sceneOfOriginal=new h["q"],this.sceneOfPreview=new h["q"]},createCamera:function(){var e=this.canvasSize.height,n=this.cameraOptions,t=n.fov,r=n.aspect,i=n.near,a=n.far,s=new h["m"](t,r,i,a);s.position.z=e/2/Math.tan(h["i"].degToRad(t/2)),this.cameraOfOriginal=s.clone(),this.cameraOfPreview=s.clone(),this.sceneOfOriginal.add(this.cameraOfOriginal),this.sceneOfPreview.add(this.cameraOfPreview)},createImageMesh:function(){var e=new h["r"],n=e.load(g.a);n.minFilter=h["h"],n.magFilter=h["h"];var t=this.canvasSize,r=t.width,i=t.height,a=new h["k"](new h["a"](r,i,0),new h["l"]({map:n}));this.imageMesh=a.clone(),this.previewMesh=a.clone(),this.sceneOfOriginal.add(this.imageMesh),this.sceneOfPreview.add(this.previewMesh)},createCornerMesh:function(){var e=this;this.positions.forEach(function(n){var t=new h["k"](new h["o"](10,10,1),new h["l"]({color:"#00ff00",side:h["c"]}));t.position.copy(n),e.cornerMeshes.push(t),e.sceneOfOriginal.add(t)})},createPlaneMesh:function(){var e=new h["o"](200,200,1),n=new h["d"](e),t=new h["l"]({color:"#ffffff",side:h["c"],opacity:.5,transparent:!0}),r=new h["f"]({color:"#00ff00"});this.planeMesh=new h["k"](e,t),this.lineSegments=new h["g"](n,r),this.sceneOfOriginal.add(this.planeMesh),this.sceneOfOriginal.add(this.lineSegments)},syncPositions:function(){var e=this,n=this.namedPositions,t=n.topLeft,r=n.topRight,i=n.bottomLeft,a=n.bottomRight;this.cornerMeshes.forEach(function(n,t){e.positions[t].copy(n.position)}),this.planeMesh.geometry.vertices[0].copy(t),this.planeMesh.geometry.vertices[1].copy(r),this.planeMesh.geometry.vertices[2].copy(i),this.planeMesh.geometry.vertices[3].copy(a),this.planeMesh.geometry.verticesNeedUpdate=!0,this.lineSegments.geometry.dispose(),this.lineSegments.geometry=new h["d"](this.planeMesh.geometry)},applyTransform:function(){var e=this.positions.reduce(function(e,n){var t=n.x,r=n.y;return[].concat(Object(c["a"])(e),[t,r])},[]),n=this.$refs.original.width/2,t=this.$refs.original.height/2,r=[-n,t,n,t,n,-t,-n,-t];this.previewMesh.matrix=m(e,r),this.previewMesh.matrixAutoUpdate=!1},render:function(){this.syncPositions(),this.applyTransform(),this.rendererOfOriginal.render(this.sceneOfOriginal,this.cameraOfOriginal),this.rendererOfPreview.render(this.sceneOfPreview,this.cameraOfPreview),requestAnimationFrame(this.render)},createHelper:function(){new f["a"](this.cornerMeshes,this.cameraOfOriginal,this.rendererOfOriginal.domElement)},createTweakPane:function(){var e=this,n=new p.a,t=function(){var t=n.addFolder({title:"PerspectiveCamera"});t.addInput(e.cameraOptions,"fov"),t.addInput(e.cameraOptions,"aspect"),t.addInput(e.cameraOptions,"near"),t.addInput(e.cameraOptions,"far"),t.addInput(e.cameraOfOriginal.position,"x"),t.addInput(e.cameraOfOriginal.position,"y"),t.addInput(e.cameraOfOriginal.position,"z")};t()}}},y=w,M=(t("c498"),t("2877")),P=Object(M["a"])(y,s,o,!1,null,"9df9a630",null),b=P.exports,S={name:"app",components:{PerspectiveTransform:b}},j=S,x=Object(M["a"])(j,i,a,!1,null,null,null),T=x.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(T)}}).$mount("#app")},c498:function(e,n,t){"use strict";var r=t("e2d3"),i=t.n(r);i.a},e2d3:function(e,n,t){},f012:function(e,n,t){e.exports=t.p+"img/clock.8341b588.jpg"}});
//# sourceMappingURL=app.9792cf57.js.map